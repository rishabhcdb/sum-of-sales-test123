<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Sales Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        #dashboard-container {
            max-width: 900px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div id="dashboard-container">
        <h1>Product Sales Dashboard</h1>
        <table id="product-sales" class="table table-striped">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Total Sales</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
            <tfoot>
                <tr>
                    <th>Total</th>
                    <th id="total-sales"></th>
                </tr>
            </tfoot>
        </table>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script>
        const csvData = 'data:text/csv;base64,UHJvZHVjdCxSZWdpb24sU2FsZXMKTGFwdG9wLE5vcnRoLDE1MDAuNTAKTW91c2UsU291dGgsMjUuOTkKS2V5Ym9hcmQsRWFzdCw4OS45OQpNb25pdG9yLFdlc3QsMzUwLjAwCkxhcHRvcCxTb3V0aCwxNDk5Ljk5Ck1vdXNlLE5vcnRoLDI0LjUwCktleWJvYXJkLFdlc3QsOTUuMDAKTW9uaXRvcixFYXN0LDM3NS4yNQ==';

        fetch(csvData)
            .then(response => response.text())
            .then(csvText => {
                const parsed = Papa.parse(csvText, {
                    header: true,
                    dynamicTyping: true,
                    skipEmptyLines: true,
                    delimitersToGuess: [',', '	', '|']
                });

                console.log(parsed);

                const data = parsed.data;
                const headers = Object.keys(data[0]).map(k => k.trim());
                const productColName = headers[0];
                const salesColName = headers[headers.length - 1];

                const productSales = {};
                data.forEach(row => {
                    const product = row[productColName];
                    const sales = parseFloat(row[salesColName]) || 0;
                    if (productSales[product]) {
                        productSales[product] += sales;
                    } else {
                        productSales[product] = sales;
                    }
                });

                const tableBody = document.querySelector('#product-sales tbody');
                let totalSales = 0;

                for (const product in productSales) {
                    if (productSales.hasOwnProperty(product)) {
                        const sales = productSales[product];
                        totalSales += sales;
                        const row = document.createElement('tr');
                        const productCell = document.createElement('td');
                        productCell.textContent = product;
                        const salesCell = document.createElement('td');
                        salesCell.textContent = sales.toFixed(2);
                        row.appendChild(productCell);
                        row.appendChild(salesCell);
                        tableBody.appendChild(row);
                    }
                }

                document.getElementById('total-sales').textContent = totalSales.toFixed(2);
            })
            .catch(error => console.error('Error fetching or parsing CSV:', error));
    </script>
</body>
</html>